#|
 This file is a part of legit
 (c) 2015 Shirakumo http://tymoon.eu (shinmera@tymoon.eu)
 Author: Nicolas Hafner <shinmera@tymoon.eu>
|#

(in-package #:org.shirakumo.legit)

(defun ensure-list (a)
  (if (listp a) a (list a)))

(defun shellify (arg)
  (when arg
    (etypecase arg
      (symbol (string-downcase arg))
      (string arg)
      (pathname (uiop:native-namestring arg))
      (real (prin1-to-string arg))
      (list (format NIL "累蔺磲疸狎＇箬屐扉纟狎绌┅┅ㄤ彐鲠玳舡秕麴豸冤ㄤ彐鲠玳舡弪蝻蝮冤ㄤ彐鲠玳舡轭瘐舄紊泰ㄤ彐磲泸鏖翳蝈箫祧邃篝蝈犴è篝蝈犴脲狎珞怙澌怙澌啜汜祆鏖翳蝈箫祧邃篝蝈犴灬礅溽ì篝蝈犴棱镤篝蝈犴泪蜱螬ㄤ彐躅汜祆鏖翳蝈箫祧邃篝蝈犴ㄦ躅篝蝈犴脲狎珞ㄥ豉疱汜箦篝蝈犴铛祆ㄦ躅汜祆骢钽磲脲怛镝溷狍舡篝蝈犴┅篝蝈犴ㄦ躅汜祆骢钽篝蝈犴┅疳翳钺礤戾è篝蝈犴ㄡ痧禊＇镳孱篝蝈犴狎珞┅ㄡ怙螋冤躅鏖钿痱雉邈痱镧ㄦ躅汜祆骢钽篝蝈犴箦翩徕矧紊泰ㄣ祜箦篝蝈犴横怙螋徕矧舂┅è羼后趄轭绌鏖翳秕麴豸麸篝蜷铉篝蝈犴ㄦ躅汜祆骢钽篝蝈犴┅è羼冤ㄦ躅汜祆骢钽篝犷溽蜾秕麴豸┅┅ㄤ彐躅泔瘗篝蝈犴ㄩ铕豸秕麴豸脲泔铙蹴瀛犰飑换族泔瘗汨狎怡汨狎麒殂轶痱弭豉箬轸疱蜴矧磲钽鏖箦换怩雉桢蝼轶麇黠蹯栳鲥麸彘翳弪翳蝈徜矧忪镢氍换怙翳镦麒殂麇溴骈铋翦禊滹麽铘麸狯镩洚麒孱镳孱篝蝈犴轭瘐舂祜镳骘汨狎蝈徜汨狎铒栳铉轭瘐紊哄镦滹ㄣ狍汨狎è紊泰躅戾篌泔铙蹴瀛犰蝈趱蝾┅ê屣蝈趱蝾┅ㄔ黩轸瀛汨狎汨狎秕麴豸┅┅┅ㄤ彐躅篝镳痱镢弩痱镢弩脲ㄡ趑屙痿卑箪邋爱暴ㄥ翦蝾犰痱镧蜥砗箝珙犰痱镢弩痱镢弩洪铘弪蝓痿祜镳蝈疱狒狒翦眇趔滹箪邋箪邋皓ㄣ狍ㄥ翦蝾犰痱镧蜥砗痱镢弩蟓篝狒躞痱镢弩螬è后麸痧邃哄轸邃蝈趱蝾┅骈钺祆ㄥ翦蝾犰痱镧蜥砗箝珙犰痱镢弩痱镢弩弘殪戾洎┅ㄤ彐躅孱篚蝈痱镢弩蟓篝镳疱痱镢弩螬麒孱ㄥㄥ翦蝾犰痱镧蜥砗痱镢弩蟓篝狒躞痱镢弩螬候躅铋铉篝镳痱镢弩痱镢弩螬┅ㄤ彐躅蝓痱镧蜥狎珞脲轭瘐秕麴豸弪蝻镱铒瞽弪锃屮轸候弭躜瞟ㄥ汜箦镱铒瞽弪锃屮轸è紊候弭躜哄蝌矧瑚狎瞟┅＋鲥蜮矬龊趄徙红彗轸狺狺痱镧蜥狎珞鏖翳蝈箫祧邃篝蝈犴秕麴豸鏖翳蝈箫祧邃篝蝈犴ㄥ蝌矧戾舄è痱镢弩ㄥ翦蝾犰痱镧蜥砗篝狎痱镧蜥狎珞猴豸瘐后趄遽哄蝌矧后趄遽洪铕豸轭瘐舂痱镢弩蟓秕麴豸ㄥ翦蝾犰痱镧蜥砗痱镢弩蟓秕麴豸篝蝈犴痱镢弩螬痱镢弩蟓弪蝻ㄥ翦蝾犰痱镧蜥砗痱镢弩蟓弪蝻颦篝蝈犴痱镢弩螬┅躅鏖钿痱雉邈祜镳滹ㄣ镳篝蝈犴痱镢弩蟓秕麴豸秕麴豸ㄣ镳篝蝈犴痱镢弩蟓弪蝻弪蝻颟麒殪ㄥㄥ翦蝾犰痱镧蜥砗痱镢弩蟓篝狒躞痱镢弩螬候躅铋铉┅ㄥ铙躜瀛痱镢弩蟓篝镳疱痱镢弩螬ㄣ镳篝蝈犴痱镢弩蟓秕麴豸秕麴豸恒镱篚礤犰冤ㄣ镳篝蝈犴痱镢弩蟓弪蝻弪蝻恒镱篚礤犰冤ㄣ祜箦痱镢弩蟓秕麴豸ㄣ祜箦痱镢弩蟓弪蝻颟戾è屮轸铘璀鲠祯ㄥ翦蝾犰痱镧蜥砗痱镢弩蟓篝狒躞痱镢弩螬┅ㄩ屮轸屮轸ㄣ狍镱铒瞽弪锃屮轸è紊泰紊泰ê蝈趱蝾屮轸ê弪蝻ㄥ蝌矧⒁瘴镦屮轸邃鏖翳岙痱镧蜥狎珞屮轸┅ê麽蝾麽蝾⒁瘴镦屮轸邃鏖翳岙痱镧蜥狎珞屮轸┅┅┅┅ㄤ彐躅蝓瞽玳é蝈篝沩溽蜱螬蝓㈢轸祜镳鏖翳扉篝ī骘狎轭沩溽蜱滹豉疱汜箦狎扉篝ㄤ镬轶ㄡ狎绌瘐箬扉篝┅ㄔ瘐箬狎扉篝┅骈钺祆蝈趱蝾铗弼弪箦扉篝┅猴豸瘐玳舡秕麴豸哄蝌矧玳舡弪蝻蝮洪铕豸玳舡轭瘐舄┅ㄤ彐躅瘐蜷纟狎珞ㄡ蜱螬磲疸狎灬礅溽ㄡㄩ扉篝岍ㄦ轵篝岍岍狎珞┅ㄤ彐躅瓠簌礅簌礅镬ㄩ铘弪ㄦ矧磲紊岘孝簌礅镬┅ㄤ彐躅骝镱舡狎绛ㄡ蜱ㄡ钿扉篝狎绌ㄦ轭烘蝻铘狎绌┅ㄤ彐磲泸溴骈铄玳舡黩狃疱钺礤蝈篝狎玟彐螬灬礅溽骈滗戾瑚轸璀溴篝蝓泗躜邃灬礅溽扉篝ê蝈聃轵邃蝈猴痿轱钺镳弘妁脲狎玟彐戾舄è瘐蝈蝈瘐蜷纟狎珞蝈瘵瘐蝈脲瘐蜷纟狎珞脲┅瘐蝈镳瘐蜷纟狎珞镳舂ㄡ蹒脲磲疸狎灬礅溽ㄡ啜紊瓠簌礅岍┅ㄡ痧孱瘐蝈镳瘐蝈脲┅┅啜溴骢钺礤ì鲤躜弪羼脲泪蹒脲螬ㄤ邈灬蝈ㄩ珙矧徕戾括磲疸狎＇翳轵狨珉妁螬┅蝓瞽玳篚怏羼篝蜷铉滹黝汜箦钺礤穿括祜镳骘狎轭蝈麒孱ㄦ蝻铘狎绛狎绌泔祆邈疳蝮瀛蜥蜱溴狎绌括祜镳骘狎轭镳麒孱ㄦ蝻铘狎绛狎绌泔祆邈疳蝮瀛镝蜱溴狎绌括磲疸狎＇疳蝮瀛脶蜱溴脲括祜镳骘狎轭蝈躅戾篌ㄦ蝻铘狎绛狎绌泔祆邈疳蝮瀛蜥蜱溴狎绌括祜镳骘狎轭镳躅戾篌ㄦ蝻铘狎绛狎绌泔祆邈疳蝮瀛镝蜱溴狎绌┅┅┅ㄤ彐磲泸ワ痿镳糸镱蝈篝骘蝽螬啜戾è狎珞ㄡ篌镢镳糸镱镳糸镱螬┅麒孱狎珞梨矧眢┅ㄤ彐磲泸狎珏豉疱汜箦簌礅怙澌镳糸镱螬啜狃疱钿扉篝у豉疱汜箦簌礅括祜镳骘钺礤骘蝽螬轭镳糸镱泔祆邈啜ワ痿钺礤梨矧眢┅┅ㄤ彐磲泸溴骈铄狎琊狎箦ㄦ躅泐犴ㄤ彐狨祠簌礅镬痱彐轼钺礤镳糸镱螬怙澌怙澌戾è狎玟彐ㄧ孱簌⒘仪呐脾┅啜溴骢骢钽钺礤ì狎玟彐ㄤ弩趄蹉趱蜷铉忾钿ì簌礅镬镳糸镱螬ㄥ铙躜瀛扉篝狎玟彐ㄤ邈灬蝈ㄩ珙矧徕戾簌礅镬┅戾舄è镳糸镱磲疸狎＇孱篚蝈扉篝矧镳糸镱Ж溴驷蹯舂┅ì钺礤ㄩㄡ篌镢侯犴镳糸镱螬箦泔钿ㄡ篌镢侯犴镳糸镱螬簌礅镬┅ì钺礤ㄩㄡ篌镢乎疸狍镳糸镱螬篝蜷铉躔汜箦钺礤篝蜷铉滹黝汜箦钺礤┅ì痱彐轼ㄩ戾铉翳钺礤暴┅ㄤ邈灬蝈ㄩ珙矧徕戾痱彐轼钺礤镳糸镱螬棱镤┅┅ㄤ彐轭瀛狎琊狎箦疳蝮瀛蜥蜱溴ê蝈簌礅镬痱彐轼钺礤镳糸镱螬ㄡ蜱弭疱汜箦簌礅镬ê啜ㄔ扉篝簌礅镬┅┅ê礤礅弪祜镳骘翳轭轭ㄣ潋狎珞泔祆邈啜ㄥ耢翳轭绌ㄦ矧磲紊狺翳轭绌┅ê蝈啜ㄔ簌礅镬┅┅ㄤ彐轭瀛狎琊狎箦疳蝮瀛镝蜱溴ê镳簌礅镬痱彐轼钺礤镳糸镱螬啜麒孱瓠簌礅簌礅镬ㄡ蜱弭疱汜箦簌礅镬ê啜ㄔ扉篝簌礅镬┅┅ê礤礅弪祜镳骘翳轭轭ㄣ潋狎珞泔祆邈啜ㄥ耢翳轭绌翳轭绌┅ê镳啜ㄔ簌礅镬┅┅┅ㄤ彐轭瀛狎琊狎箦疳蝮瀛脶蜱溴ê骒徵簌礅镬痱彐轼钺礤镳糸镱螬啜麒孱瓠簌礅簌礅镬ㄡ蜱弭疱汜箦簌礅镬ê骒徵啜è羼冤ㄦ矧磲紊狺幄痱彐轼钺礤┅┅ê怙镬啜铛祆ㄦ矧磲紊铒幄钺礤┅┅ê礤礅弪祜镳骘翳轭轭ㄣ潋狎珞泔祆邈啜ㄥ耢翳轭绌ㄦ矧磲紊狺峤狺痱彐轼钺礤翳轭绌┅ê狎啜è铒铛祆扉篝ㄦ矧磲紊狺幄痱彐轼钺礤箬屐扉纟簌礅镬┅┅ê狎缃啜è铒铛祆ㄦ矧磲紊ㄦ矧磲紊狺峤幄痱彐轼钺礤箬屐扉纟簌礅镬┅┅ê狎绠啜è铒铛祆ㄦ矧磲紊ㄦ矧磲紊狺狺幄痱彐轼钺礤箬屐扉纟簌礅镬┅┅ê磲啜扉篝祜镳骘脲鲠飑轭簌礅镬泔祆邈ㄦ矧磲紊ㄦ矧磲紊狺狺狺幄痱彐轼钺礤矧ㄦ轵篝镳糸镱螬⒔┅箬屐扉纟脲箬屐扉纟鲠飑┅┅ê骒徵啜ㄔ┅ê怙镬啜ㄔㄦ矧磲紊狺幄痱彐轼钺礤┅┅┅ㄤ彐珏铄蜷祜汜糸镱翳轭绌ê礤翳镤è疳翳钺礤疳翳钺礤┅疳翳钺礤ê礤翳镤è篝蜷铉篝蜷铉┅蹰镳吼狎箦钺糸鲥钺礤篝蜷铉篝蜷铉┅ㄤ彐磲泸鏖翳汨溟è铄鳝疳翳怙澌怙澌戾è镬ㄧ孱簌⑾棠┅铄ㄧ孱簌⑽抛┅啜戾舄è镬矧ㄩ珙矧瀛弪蝻蝮蹰镳虹弭泖洎躞弪栾礤溟颦疳翳钺礤┅ì铄祜汜糸镱铄鳝疳翳┅í溴驷蹯舡疳翳钺礤溴驷蹯趔铄鳗躅鏖钿痱雉邈痱镧ㄥ铙躜瀛溟蝈泗矧殄蟓屮轶铄鳗蹰镳恒桎轵铄鳗棱镤蹰镳恒桎轵镬洎┅┅ㄤ彐躅黹铋磲飙箬屐飙钺礤篝蜷铉疳翳钺礤蹰镳侯狒轹瀛钺礤篝蜷铉蹰镳哄铒蹒璀疳翳钺礤疳翳钺礤蹰镳虹弭泖洎┅ㄤ彐躅蝈灬糸鲥溟蝈灬糸鲥蝈篝篚怃轵螬祜镳骘篚轭篚怃轵骘溟礤蜱瀛疳翳钺礤蹰镳哄铙躜瀛溟蝈泗矧疳翳钺礤篚猢蹰镳哄铙躜瀛溟蝈泗矧疳翳钺礤蝈灬糸鲥┅翳孱礤蜱瀛疳翳钺礤蹰镳哄铙躜瀛溟蝈泗矧疳翳钺礤篚猢溟颟骈钺祆蝈趱蝾溟颟┅ㄤ彐鲠躅轼屦镢璀溟骀弪孱沐ㄥ钽镤瀛躅轹弪筢飙糸礤惫钒癌ㄤ彐躅躅轹弪筢飙麸躅轼糸礤躅轹弪筢飙糸礤ō躅轹弪筢飙糸礤躅轼屦镢璀溟骀弪孱沐┅ㄤ彐躅躅轼麸躅轹弪筢飙糸礤躅轼糸礤ǐ躅轼糸礤躅轼屦镢璀溟骀弪孱沐┅